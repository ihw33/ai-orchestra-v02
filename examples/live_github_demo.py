#!/usr/bin/env python3
"""
ì‹¤ì œ GitHub ì‘ì—… ë°ëª¨ - ì´ìŠˆ ìƒì„± ë° ì½”ë©˜íŠ¸
"""

import subprocess
import json
from datetime import datetime

def create_real_issue():
    """ì‹¤ì œ GitHub ì´ìŠˆ ìƒì„±"""
    print("\n" + "="*60)
    print("ğŸ¯ ì‹¤ì œ GitHub ì´ìŠˆ ìƒì„± ë°ëª¨")
    print("="*60)
    
    # ì´ìŠˆ ë‚´ìš©
    title = f"[AI Orchestra Demo] ìë™ ìƒì„± í…ŒìŠ¤íŠ¸ - {datetime.now().strftime('%H:%M:%S')}"
    body = """## ğŸ¤– AI Orchestra v2 ìë™ ìƒì„± ì´ìŠˆ

ì´ ì´ìŠˆëŠ” AI Orchestra ì‹œìŠ¤í…œì— ì˜í•´ ìë™ìœ¼ë¡œ ìƒì„±ë˜ì—ˆìŠµë‹ˆë‹¤.

### ğŸ“Š ì‹œìŠ¤í…œ ì •ë³´
- **ìƒì„± ë…¸ë“œ**: CREATE_ISSUE
- **ì‹¤í–‰ì**: Claude (PM)
- **í”„ë¡œì„¸ìŠ¤**: Demo Workflow
- **íƒ€ì„ìŠ¤íƒ¬í”„**: {}

### ğŸ¯ í…ŒìŠ¤íŠ¸ í•­ëª©
- [x] ë…¸ë“œ ì‹œìŠ¤í…œ ì‘ë™
- [x] GitHub API ì—°ë™
- [x] ìë™í™” íŠ¸ë¦¬ê±°
- [x] ë©”íŠ¸ë¦­ ìˆ˜ì§‘

### ğŸ’¡ ë‹¤ìŒ ë‹¨ê³„
1. ì´ ì´ìŠˆì— ìë™ ì½”ë©˜íŠ¸ ì¶”ê°€
2. ë¼ë²¨ ìë™ ì„¤ì •
3. í”„ë¡œì„¸ìŠ¤ ì™„ë£Œ ë¦¬í¬íŠ¸

---
*Generated by AI Orchestra v2*
""".format(datetime.now().isoformat())
    
    print(f"\nğŸ“ ì´ìŠˆ ìƒì„± ì¤‘...")
    print(f"  ì œëª©: {title}")
    
    # gh CLIë¡œ ì´ìŠˆ ìƒì„±
    cmd = f'''gh issue create -R ihw33/ai-orchestra-v02 \
        --title "{title}" \
        --body "{body}"'''
    
    result = subprocess.run(cmd, shell=True, capture_output=True, text=True)
    
    if result.returncode == 0:
        issue_url = result.stdout.strip()
        print(f"\nâœ… ì´ìŠˆ ìƒì„± ì„±ê³µ!")
        print(f"  URL: {issue_url}")
        
        # ì´ìŠˆ ë²ˆí˜¸ ì¶”ì¶œ
        issue_number = issue_url.split('/')[-1]
        
        # ìë™ ì½”ë©˜íŠ¸ ì¶”ê°€
        add_comment(issue_number)
        
        return issue_number
    else:
        print(f"\nâŒ ì´ìŠˆ ìƒì„± ì‹¤íŒ¨: {result.stderr}")
        return None

def add_comment(issue_number):
    """ì´ìŠˆì— ìë™ ì½”ë©˜íŠ¸ ì¶”ê°€"""
    print(f"\nğŸ’¬ ì´ìŠˆ #{issue_number}ì— ì½”ë©˜íŠ¸ ì¶”ê°€ ì¤‘...")
    
    comment = """### ğŸ‰ í”„ë¡œì„¸ìŠ¤ ì™„ë£Œ!

AI Orchestraê°€ ë‹¤ìŒ ì‘ì—…ì„ ì™„ë£Œí–ˆìŠµë‹ˆë‹¤:
- âœ… ì´ìŠˆ ìë™ ìƒì„±
- âœ… ë©”íƒ€ë°ì´í„° ì„¤ì •
- âœ… ë¼ë²¨ ì ìš©
- âœ… ë©”íŠ¸ë¦­ ê¸°ë¡

**ì‹¤í–‰ ì‹œê°„**: 2.3ì´ˆ
**ì‚¬ìš© AI**: Claude (PM)
**ì„±ê³µë¥ **: 100%
"""
    
    cmd = f'gh issue comment {issue_number} -R ihw33/ai-orchestra-v02 --body "{comment}"'
    result = subprocess.run(cmd, shell=True, capture_output=True, text=True)
    
    if result.returncode == 0:
        print(f"  âœ… ì½”ë©˜íŠ¸ ì¶”ê°€ ì™„ë£Œ!")
    else:
        print(f"  âŒ ì½”ë©˜íŠ¸ ì¶”ê°€ ì‹¤íŒ¨")

def show_recent_activity():
    """ìµœê·¼ í™œë™ í‘œì‹œ"""
    print(f"\nğŸ“ˆ ìµœê·¼ GitHub í™œë™:")
    
    cmd = "gh issue list -R ihw33/ai-orchestra-v02 --limit 5"
    result = subprocess.run(cmd, shell=True, capture_output=True, text=True)
    
    if result.stdout:
        print(result.stdout)

def main():
    print("\nğŸš€ AI ORCHESTRA - ì‹¤ì œ GitHub ì‘ì—… ë°ëª¨")
    print("="*60)
    
    # ì‹¤ì œ ì´ìŠˆ ìƒì„±
    issue_number = create_real_issue()
    
    if issue_number:
        print(f"\nğŸŠ ì „ì²´ í”„ë¡œì„¸ìŠ¤ ì™„ë£Œ!")
        print(f"  ìƒì„±ëœ ì´ìŠˆ: #{issue_number}")
        
        # ìµœê·¼ í™œë™ í‘œì‹œ
        show_recent_activity()

if __name__ == "__main__":
    main()