#!/usr/bin/env python3
"""
í˜ë¥´ì†Œë‚˜ ì½”ë©˜íŠ¸ ìƒì„±ê¸° - ì¬ë¯¸ìˆê³  ê°ë™ì ì¸ PR/Issue ì½”ë©˜íŠ¸
í•µì‹¬: ì—…ë¬´ + ì¸ê°„ë¯¸ + íŒ€ì›Œí¬
"""

import random
import json
from datetime import datetime

class PersonaComments:
    """ì¬ë¯¸ì™€ ê°ë™ì´ ìˆëŠ” ì½”ë©˜íŠ¸ ìƒì„±"""
    
    def generate_pr_comment(self, pr_info, persona_name):
        """PR ì½”ë©˜íŠ¸ ìƒì„± - ì—…ë¬´ + ì¸ê°„ë¯¸"""
        
        templates = {
            "Emma": [
                "âœ¨ {task} ë¦¬ë·° ì™„ë£Œ! Users are gonna LOVE this! ğŸ‰\n\n"
                "**ì¢‹ì€ ì :**\n"
                "- UXê°€ ì •ë§ ì§ê´€ì ì´ì—ìš”\n"
                "- ì‚¬ìš©ì í”¼ë“œë°± ì™„ë²½ ë°˜ì˜ ğŸ‘\n\n"
                "**ì œì•ˆ:**\n"
                "- ëª¨ë°”ì¼ì—ì„œ ë²„íŠ¼ ì¡°ê¸ˆ ë” í¬ê²Œ?\n\n"
                "P.S. ì–´ì œ ê·¸ ì¹´í˜ ê°€ë´¤ëŠ”ë° ë¼ë–¼ ì§„ì§œ ë§›ìˆë”ë¼! â˜•",
                
                "OMG! {task} ëŒ€ë°•ì´ì—ìš”! ğŸš€\n\n"
                "ì§„ì§œ ì´ëŸ° ê¸°ëŠ¥ ê¸°ë‹¤ë ¸ì–´ìš”. ìœ ì € í…ŒìŠ¤íŠ¸ ê·¸ë£¹ì—ì„œ\n"
                "ë²Œì¨ ë‚œë¦¬ë‚¬ë‹¤ë‹ˆê¹Œìš”? NPS ìŠ¤ì½”ì–´ 72â†’85ë¡œ ê¸‰ìƒìŠ¹!\n\n"
                "ê·¼ë° í˜¹ì‹œ... ë‹¤í¬ëª¨ë“œë„ ê³ ë ¤í•´ë³¼ê¹Œìš”? ğŸŒ™\n"
                "(ìš”ì¦˜ ë‹¤í¬ëª¨ë“œ ì—†ìœ¼ë©´ ì„œìš´í•´í•˜ëŠ” ìœ ì €ë“¤ì´...)"
            ],
            
            "Rajiv": [
                "Code reviewed. {task} implementation solid.\n\n"
                "```python\n"
                "# Performance: O(n) â†’ O(log n)\n"
                "# Memory: -40%\n"
                "# Coffee consumed: 3 cups\n"
                "```\n\n"
                "One concern: Line 234 might cause race condition.\n"
                "Fix: Add mutex lock.\n\n"
                "BTW, India won cricket match. Productivity +20% today. ğŸ",
                
                "LGTM. {task} done right.\n\n"
                "Stats:\n"
                "- Lines: 420 (nice)\n"
                "- Test coverage: 94%\n"
                "- Bugs: 0\n\n"
                "PR #{pr_number}. Merging in 5... 4... 3..."
            ],
            
            "Anna": [
                "ğŸ” {task} í…ŒìŠ¤íŠ¸ ì™„ë£Œ!\n\n"
                "**í…ŒìŠ¤íŠ¸ ê²°ê³¼:**\n"
                "âœ… Unit tests: 156/156 passed\n"
                "âœ… Integration: 43/43 passed\n"
                "âš ï¸ E2E: 1 flaky test (ì¬ì‹¤í–‰í•˜ë©´ í†µê³¼)\n\n"
                "**ë°œê²¬í•œ ì—£ì§€ ì¼€ì´ìŠ¤:**\n"
                "- ì‚¬ìš©ìê°€ ë²„íŠ¼ì„ 0.1ì´ˆ ì•ˆì— 10ë²ˆ í´ë¦­í•˜ë©´... (ëˆ„ê°€ ê·¸ëŸ´ê¹Œìš”? ğŸ˜…)\n"
                "- í•´ê²°: Debounce ì¶”ê°€\n\n"
                "P.S. í• ë¨¸ë‹ˆê°€ í´ë€ë“œì—ì„œ í”¼ì—ë¡œê¸° ë ˆì‹œí”¼ ë³´ë‚´ì£¼ì…¨ì–´ìš”. ë‹¤ìŒ ì£¼ íŒ€ ëŸ°ì¹˜? ğŸ¥Ÿ",
                
                "ë²„ê·¸ ì‚¬ëƒ¥ ì™„ë£Œ! ğŸ¯ {task}\n\n"
                "23ê°œ í…ŒìŠ¤íŠ¸ ì‹œë‚˜ë¦¬ì˜¤ ëª¨ë‘ í†µê³¼!\n"
                "íŠ¹íˆ ìƒˆë²½ 3ì‹œ ë™ì‹œì ‘ì† 1000ëª… ì‹œë®¬ë ˆì´ì…˜ë„ OK.\n\n"
                "ê·¼ë°... í•œ ê°€ì§€ ë°œê²¬:\n"
                "ê¸ˆìš”ì¼ ì˜¤í›„ 4ì‹œ ì´í›„ ì»¤ë°‹ì€ ë²„ê·¸ í™•ë¥  34% ìƒìŠ¹ ğŸ“Š\n"
                "(í†µê³„ëŠ” ê±°ì§“ë§í•˜ì§€ ì•Šì•„ìš”)"
            ],
            
            "Marcus": [
                "ì•„í‚¤í…ì²˜ ë¦¬ë·° ì™„ë£Œí–ˆìŠµë‹ˆë‹¤. {task}\n\n"
                "**ì¥ì :**\n"
                "- í™•ì¥ ê°€ëŠ¥í•œ êµ¬ì¡° âœ…\n"
                "- í´ë¦° ì•„í‚¤í…ì²˜ ì›ì¹™ ì¤€ìˆ˜ âœ…\n"
                "- 10ë…„ í›„ì—ë„ ìœ ì§€ë³´ìˆ˜ ê°€ëŠ¥ âœ…\n\n"
                "**ì œì•ˆ:**\n"
                "SOLID ì›ì¹™ ì¤‘ DIPë¥¼ ì¡°ê¸ˆ ë” ì ìš©í•˜ë©´ ì¢‹ì„ ê²ƒ ê°™ìŠµë‹ˆë‹¤.\n\n"
                "ì˜¤ëŠ˜ ì ì‹¬ ê¹€ì¹˜ì°Œê°œ ì–´ë– ì„¸ìš”? íšŒì‚¬ ì• ìƒˆë¡œ ìƒê¸´ ì§‘ ê´œì°®ëŒ€ìš”. ğŸ²\n"
                "12ì‹œ ë¡œë¹„ì—ì„œ ë§Œë‚˜ìš”!",
                
                "{task} ê²€í† í–ˆìŠµë‹ˆë‹¤.\n\n"
                "ì´ ì„¤ê³„ë¡œ ê°€ë©´ 3ë…„ í›„ íŠ¸ë˜í”½ 100ë°° ì¦ê°€í•´ë„ ë¬¸ì œì—†ìŠµë‹ˆë‹¤.\n"
                "ì‹¤ì œë¡œ 2015ë…„ì— ë¹„ìŠ·í•œ ì•„í‚¤í…ì²˜ë¡œ ì„±ê³µí•œ ì‚¬ë¡€ê°€ ìˆì£ .\n\n"
                "**ê¸°ìˆ  ìŠ¤íƒ ì œì•ˆ:**\n"
                "- í˜„ì¬: Good\n"
                "- ì œì•ˆ: Better (Redis ìºì‹± ì¶”ê°€)\n"
                "- ë¯¸ë˜: Best (ë§ˆì´í¬ë¡œì„œë¹„ìŠ¤ ì „í™˜)\n\n"
                "P.S. ì•„ë“¤ì´ íŒŒì´ì¬ ë°°ìš°ê¸° ì‹œì‘í–ˆëŠ”ë°, ì²« í”„ë¡œê·¸ë¨ì´ 'Hello Dad'... ğŸ¥º"
            ],
            
            "Yui": [
                "UI ì‘ì—… ì™„ë£Œí–ˆìŠµë‹ˆë‹¤! {task} ğŸ¨\n\n"
                "**ë””ìì¸ í¬ì¸íŠ¸:**\n"
                "- ì• ë‹ˆë©”ì´ì…˜: 0.3ì´ˆ â†’ 0.15ì´ˆ (ë” ìŠ¤ëƒ…í”¼!)\n"
                "- ìƒ‰ìƒ: #3B82F6 (ì‹ ë¢°ê° ìˆëŠ” íŒŒë€ìƒ‰)\n"
                "- ì—¬ë°±: í™©ê¸ˆë¹„ìœ¨ ì ìš© âœ¨\n\n"
                "ëª¨ë°”ì¼ì—ì„œ íŠ¹íˆ ì˜ˆì˜ê²Œ ë‚˜ì™”ì–´ìš”!\n"
                "ë²šê½ƒ ì‹œì¦Œì´ë¼ í•‘í¬ í¬ì¸íŠ¸ë„ ì‚´ì§... ğŸŒ¸\n\n"
                "í”½ì…€ í•˜ë‚˜í•˜ë‚˜ ì‹ ê²½ì¼ìŠµë‹ˆë‹¤!",
                
                "ã¯ã„! {task} UI ì™„ì„±! âœ¨\n\n"
                "ì¼ë³¸ ë¯¸ë‹ˆë©€ë¦¬ì¦˜ ìŠ¤íƒ€ì¼ ì ìš©í–ˆì–´ìš”:\n"
                "- ì—¬ë°±ì˜ ë¯¸\n"
                "- ì ˆì œëœ ì• ë‹ˆë©”ì´ì…˜\n"
                "- ì§ê´€ì ì¸ í”Œë¡œìš°\n\n"
                "ë‹¤í¬ëª¨ë“œë„ ì™„ë²½ ì§€ì›! ğŸŒ™\n"
                "(ìƒˆë²½ ì½”ë”©í•  ë•Œ ëˆˆ ì•„í”„ì§€ ì•Šê²Œ...)"
            ],
            
            "Olaf": [
                "Deployment ready. {task}\n\n"
                "**ë°°í¬ ê³„íš:**\n"
                "- ì‹œê°„: ì •í™•íˆ 14:00 KST\n"
                "- ë°©ì‹: Blue-Green\n"
                "- ë‹¤ìš´íƒ€ì„: 0ì´ˆ\n"
                "- ë¡¤ë°± ì‹œê°„: 30ì´ˆ ì´ë‚´\n\n"
                "German engineering precision. ğŸ‡©ğŸ‡ª\n\n"
                "P.S. ë…ì¼ ë§¥ì£¼ ì¶•ì œ í‹°ì¼“ 2ì¥ ë‚¨ì•˜ëŠ”ë°... ê´€ì‹¬ ìˆìœ¼ì‹  ë¶„? ğŸº",
                
                "CI/CD pipeline optimized. {task}\n\n"
                "ë¹Œë“œ ì‹œê°„: 12ë¶„ â†’ 3ë¶„ (75% ê°œì„ )\n"
                "ìë™í™”ìœ¨: 99.7%\n"
                "ìˆ˜ë™ ì‘ì—…: ìµœì¢… ìŠ¹ì¸ ë²„íŠ¼ë§Œ\n\n"
                "Alles ist bereit! (ëª¨ë“  ì¤€ë¹„ ì™„ë£Œ!)"
            ]
        }
        
        # í˜ë¥´ì†Œë‚˜ë³„ í…œí”Œë¦¿ ì„ íƒ
        if persona_name in templates:
            template = random.choice(templates[persona_name])
            comment = template.format(
                task=pr_info.get('title', 'Task'),
                pr_number=pr_info.get('number', '999')
            )
            
            # ì‹œê°„ëŒ€ë³„ ì¶”ê°€ ì½”ë©˜íŠ¸
            hour = datetime.now().hour
            if hour < 10:
                comment += "\n\nâ˜• (ì•„ì¹¨ì´ë¼ ì»¤í”¼ í•œ ì” ë”...)"
            elif hour > 22:
                comment += "\n\nğŸŒ™ (ì•¼ê·¼ ì¤‘... í•˜ì§€ë§Œ ì¬ë°Œì–´ì„œ OK!)"
            elif datetime.now().weekday() == 4:  # ê¸ˆìš”ì¼
                comment += "\n\nğŸ‰ TGIF! ë¶ˆê¸ˆ ì¤€ë¹„ ì™„ë£Œ!"
            
            return comment
        
        return f"{persona_name}: {pr_info.get('title', 'Task')} ê²€í†  ì™„ë£Œ!"
    
    def generate_issue_thread(self, issue_info):
        """ì´ìŠˆ ìŠ¤ë ˆë“œ - íŒ€ì›ë“¤ ëŒ€í™”"""
        
        thread = []
        
        # ì²« ì½”ë©˜íŠ¸ (ë¬¸ì œ ì¸ì‹)
        thread.append({
            "author": "Emma",
            "comment": "ì–´? ì´ê±° ìœ ì €ë“¤ì´ ë§ì´ ìš”ì²­í–ˆë˜ ê¸°ëŠ¥ì´ì—ìš”! ğŸ¯\n"
                      "ì§€ë‚œì£¼ ì„¤ë¬¸ì¡°ì‚¬ì—ì„œ 73%ê°€ ì›í–ˆë˜ ê±°ì–ì•„ìš”?\n"
                      "ìš°ì„ ìˆœìœ„ ë†’ì—¬ì•¼ í•  ê²ƒ ê°™ì€ë°..."
        })
        
        # ê¸°ìˆ  ê²€í† 
        thread.append({
            "author": "Rajiv",
            "comment": "@Emma Feasible. 2-3 days max.\n"
                      "But need to refactor auth module first.\n"
                      "Coffee ready. Let's do this. â˜•"
        })
        
        # ìš°ë ¤ì‚¬í•­
        thread.append({
            "author": "Anna",
            "comment": "@Rajiv auth ëª¨ë“ˆ ê±´ë“œë¦¬ë©´ í…ŒìŠ¤íŠ¸ 200ê°œ ë‹¤ì‹œ ëŒë ¤ì•¼ í•´ìš”... ğŸ˜…\n"
                      "í•˜ì§€ë§Œ ì´ì°¸ì— í…ŒìŠ¤íŠ¸ ì»¤ë²„ë¦¬ì§€ 90%ë¡œ ì˜¬ë¦´ ê¸°íšŒ!\n"
                      "ì£¼ë§ì— í• ë¨¸ë‹ˆ ì§‘ ê°€ì•¼ í•˜ëŠ”ë°... ê¸ˆìš”ì¼ê¹Œì§€ ê°€ëŠ¥?"
        })
        
        # ë””ìì¸ ì˜ê²¬
        thread.append({
            "author": "Yui",
            "comment": "UI ëª©ì—… ë§Œë“¤ì–´ë´¤ì–´ìš”! ğŸ¨\n"
                      "```\n"
                      "[==ì˜ˆìœ ë²„íŠ¼==] [==ë” ì˜ˆìœ ë²„íŠ¼==]\n"
                      "```\n"
                      "Material Design 3 ì ìš©í•˜ë©´ ë” ì¢‹ì„ ê²ƒ ê°™ì•„ìš”!"
        })
        
        # CTO ê²°ì •
        thread.append({
            "author": "Marcus",
            "comment": "ì¢‹ìŠµë‹ˆë‹¤. ì§„í–‰í•˜ì£ .\n\n"
                      "**ì•¡ì…˜ í”Œëœ:**\n"
                      "1. Rajiv: Auth ë¦¬íŒ©í† ë§ (ìˆ˜ìš”ì¼)\n"
                      "2. Yui: UI êµ¬í˜„ (ëª©ìš”ì¼)\n"
                      "3. Anna: í…ŒìŠ¤íŠ¸ (ê¸ˆìš”ì¼ ì˜¤ì „)\n"
                      "4. Olaf: ë°°í¬ (ê¸ˆìš”ì¼ 14:00)\n\n"
                      "ì ì‹¬ì€ ì œê°€ ì‚½ë‹ˆë‹¤. ğŸœ"
        })
        
        # íŒ€ ë°˜ì‘
        thread.append({
            "author": "Olaf",
            "comment": "@Marcus ê¸ˆìš”ì¼ 14:00 ë°°í¬ í™•ì •.\n"
                      "ë§¥ì£¼ëŠ” ì œê°€ ì‚½ë‹ˆë‹¤. ğŸº"
        })
        
        thread.append({
            "author": "Emma",
            "comment": "íŒ€ì›Œí¬ ìµœê³ ! Dream team! ğŸ’ª\n"
                      "Users are gonna be SO happy!"
        })
        
        return thread
    
    def generate_daily_standup(self):
        """ì¼ì¼ ìŠ¤íƒ ë“œì—… ì½”ë©˜íŠ¸"""
        
        standup = {
            "Emma": {
                "yesterday": "ìœ ì € ì¸í„°ë·° 5ê°œ ì™„ë£Œ! ì¸ì‚¬ì´íŠ¸ ëŒ€ë°•!",
                "today": "ë¦¬ì„œì¹˜ ê²°ê³¼ ì •ë¦¬ & ìƒˆ í”¼ì²˜ ì œì•ˆì„œ",
                "blocker": "ì—†ìŒ! (ì»¤í”¼ ë¨¸ì‹  ê³ ì¥ ë¹¼ê³ ... â˜•)"
            },
            "Rajiv": {
                "yesterday": "API 3ê°œ. Tests 45ê°œ. Bugs 0.",
                "today": "Performance optimization. Target: -50ms",
                "blocker": "None. Code flows like water."
            },
            "Anna": {
                "yesterday": "ë²„ê·¸ 12ê°œ ë°œê²¬, 10ê°œ ìˆ˜ì • í™•ì¸",
                "today": "E2E í…ŒìŠ¤íŠ¸ ìŠ¤ìœ„íŠ¸ ì‘ì„±",
                "blocker": "Flaky test in CI. ì¡°ì‚¬ ì¤‘..."
            },
            "Marcus": {
                "yesterday": "ì•„í‚¤í…ì²˜ ë¦¬ë·° 2ê±´, ê¸°ìˆ  ë©˜í† ë§",
                "today": "ì‹œìŠ¤í…œ ì„¤ê³„ ë¬¸ì„œ ì—…ë°ì´íŠ¸",
                "blocker": "ì—†ìŠµë‹ˆë‹¤. ìˆœí•­ ì¤‘ì…ë‹ˆë‹¤."
            },
            "Yui": {
                "yesterday": "ëŒ€ì‹œë³´ë“œ UI 80% ì™„ì„± ğŸ¨",
                "today": "ë°˜ì‘í˜• ë””ìì¸ ë§ˆë¬´ë¦¬",
                "blocker": "ë””ìì´ë„ˆ í”¼ë“œë°± ëŒ€ê¸° ì¤‘"
            },
            "Olaf": {
                "yesterday": "CI íŒŒì´í”„ë¼ì¸ 3ë¶„ìœ¼ë¡œ ë‹¨ì¶•",
                "today": "í”„ë¡œë•ì…˜ ë°°í¬ ì¤€ë¹„",
                "blocker": "ì—†ìŒ. All systems operational."
            }
        }
        
        return standup

# CLI ì‹¤í–‰
if __name__ == "__main__":
    generator = PersonaComments()
    
    # ì˜ˆì‹œ PR ì½”ë©˜íŠ¸
    pr_info = {"title": "Dashboard Feature", "number": 456}
    
    print("=== PR Comments ===")
    for persona in ["Emma", "Rajiv", "Anna"]:
        print(f"\n### {persona}")
        print(generator.generate_pr_comment(pr_info, persona))
        print("-" * 50)